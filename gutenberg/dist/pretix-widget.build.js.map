{"version":3,"file":"pretix-widget.build.js","mappings":"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","sources":["webpack://pretix-widget/./src/blocks/pretix-widget/edit.js","webpack://pretix-widget/./src/blocks/pretix-widget/index.js","webpack://pretix-widget/./src/blocks/pretix-widget/save.js"],"sourcesContent":["const {useEffect, useState} = wp.element;\r\nconst { registerBlockType } = wp.blocks;\r\nconst { __ } = wp.i18n;\r\nconst { TextControl, ToggleControl, SelectControl, PanelBody, ToolbarGroup } = wp.components;\r\nconst { serverSideRender: ServerSideRender } = wp;\r\n\r\nconst {\r\n\tInnerBlocks,\r\n\tuseBlockProps,\r\n\tInspectorControls,\r\n\tBlockControls,\r\n\tstore\r\n} = wp.blockEditor;\r\n\r\nexport default function Edit(props) {\r\n\tconst {\r\n\t\tclientId,\r\n\t\tattributes,\r\n\t\tsetAttributes,\r\n\t} = props;\r\n\r\n\t// add defaults to attributes\r\n\tconst {\r\n\t\talign,\r\n\t\tmode = 'widget',\r\n\t\tdisplay = 'list',\r\n\t\tshop_url = '',\r\n\t\titems = '',\r\n\t\tcategories = '',\r\n\t\tvariations = '',\r\n\t\tdisable_voucher = false,\r\n\t\tallocated_voucher = '',\r\n\t\tlanguage = 'en',\r\n\t\tbutton_text = 'Buy Ticket!',\r\n\t} = attributes;\r\n\t\r\n\tconst [loading, setLoading] = useState(false);\r\n\t\r\n\tconst handleChange = (key, value) => {\r\n\t\tsetAttributes({ [key]: value });\r\n\t}\r\n\t\r\n\tconst insertScriptAssets = () =>{\r\n\t\tconst scriptId = 'pretix-widget-script-' + clientId;\r\n\t\tlet script = document.getElementById(scriptId);\r\n\t\tif(script){\r\n\t\t\tdocument.body.removeChild(script);\r\n\t\t}\r\n\t\tscript = document.createElement(\"script\");\r\n\t\tscript.id = scriptId;\r\n\t\twindow.PretixWidget = null;\r\n\t\t\r\n\t\tconst url = new URL(shop_url);\r\n\t\tscript.src = `https://${url.hostname}/widget/v1.${language}.js?timestamp=${Date.now()}`;\r\n\t\tscript.async = true;\r\n\t\tscript.onload = () => {\r\n\t\t\twindow.PretixWidget.buildWidgets();\r\n\t\t};\r\n\t\tdocument.body.appendChild(script);\r\n\t\tsetLoading(false);\r\n\t}\r\n\t\r\n\tconst insertCSSAssets = () =>{\r\n\t\tconst linkId = 'pretix-widget-style-' + clientId;\r\n\t\tlet link = document.getElementById(linkId);\r\n\t\tif(link){\r\n\t\t\tdocument.body.removeChild(link);\r\n\t\t}\r\n\t\tlink = document.createElement(\"link\");\r\n\t\tlink.rel = \"stylesheet\";\r\n\t\tlink.href = `https://pretix.eu/demo/democon/widget/v1.css?timestamp=${Date.now()}`;\r\n\t\tdocument.head.appendChild(link);\r\n\t}\r\n\t\r\n\tuseEffect(() => {\r\n\t\tconsole.log('mount');\r\n\t\tsetLoading(true);\r\n\t\tinsertScriptAssets();\r\n\t\tinsertCSSAssets();\r\n\t},[]);\r\n\t\r\n\tuseEffect(() => {\r\n\t\tconsole.log('language');\r\n\t\tif(!loading) insertScriptAssets();\r\n\t},[language]);\r\n\t\r\n\tuseEffect(() => {\r\n\t\tconsole.log('update');\r\n\t\tconsole.log(window.PretixWidget);\r\n\t\tif(window.PretixWidget){\r\n\t\t\twindow.PretixWidget.buildWidgets();\r\n\t\t}\r\n\t\tinsertCSSAssets();\r\n\t},[attributes]);\r\n\t\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<BlockControls>\r\n\t\t\t\t<ToolbarGroup>\r\n\t\t\t\t\t<SelectControl\r\n\t\t\t\t\t\tlabel={__('Align', 'pretix-widget')}\r\n\t\t\t\t\t\tvalue={align}\r\n\t\t\t\t\t\toptions={[\r\n\t\t\t\t\t\t\t{ value: 'left', label: __('Left', 'pretix-widget') },\r\n\t\t\t\t\t\t\t{ value: 'center', label: __('Center', 'pretix-widget') },\r\n\t\t\t\t\t\t\t{ value: 'right', label: __('Right', 'pretix-widget') },\r\n\t\t\t\t\t\t\t{ value: 'wide', label: __('Wide', 'pretix-widget') },\r\n\t\t\t\t\t\t\t{ value: 'full', label: __('Full', 'pretix-widget') },\r\n\t\t\t\t\t\t]}\r\n\t\t\t\t\t\tonChange={(value) => setAttributes({ align: value })}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</ToolbarGroup>\r\n\t\t\t</BlockControls>\r\n\t\t\t<InspectorControls>\r\n\t\t\t\t<PanelBody title={__('Settings', 'pretix-widget')} initialOpen={true}>\r\n\t\t\t\t\t<SelectControl\r\n\t\t\t\t\t\tlabel={__('Mode', 'pretix-widget')}\r\n\t\t\t\t\t\tvalue={mode}\r\n\t\t\t\t\t\toptions={[\r\n\t\t\t\t\t\t\t{ value: 'widget', label: __('Widget', 'pretix-widget') },\r\n\t\t\t\t\t\t\t{ value: 'button', label: __('Button', 'pretix-widget') },\r\n\t\t\t\t\t\t]}\r\n\t\t\t\t\t\tonChange={(value) => handleChange('mode', value)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t{mode === 'button' && (\r\n\t\t\t\t\t\t<TextControl\r\n\t\t\t\t\t\t\tlabel={__('Button Text', 'pretix-widget')}\r\n\t\t\t\t\t\t\tvalue={button_text}\r\n\t\t\t\t\t\t\tonChange={(value) => handleChange('button_text', value)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t<TextControl\r\n\t\t\t\t\t\tlabel={__('Shop URL', 'pretix-widget')}\r\n\t\t\t\t\t\tvalue={shop_url}\r\n\t\t\t\t\t\tonChange={(value) => handleChange('shop_url', value)}\r\n\t\t\t\t\t\ttype=\"url\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t{/*\r\n\t\t\t\t\t<TextControl\r\n\t\t\t\t\t\tlabel={__('Event', 'pretix-widget')}\r\n\t\t\t\t\t\tvalue={event}\r\n\t\t\t\t\t\tonChange={(value) => handleChange('event', value)}\r\n\t\t\t\t\t/>*/}\r\n\t\t\t\t\t<TextControl\r\n\t\t\t\t\t\tlabel={__('Items', 'pretix-widget')}\r\n\t\t\t\t\t\tvalue={items}\r\n\t\t\t\t\t\tonChange={(value) => handleChange('items', value)}\r\n\t\t\t\t\t\thelp={__('Enter a comma-separated list of ID numbers.', 'pretix-widget')}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<TextControl\r\n\t\t\t\t\t\tlabel={__('Categories', 'pretix-widget')}\r\n\t\t\t\t\t\tvalue={categories}\r\n\t\t\t\t\t\tonChange={(value) => handleChange('categories', value)}\r\n\t\t\t\t\t\thelp={__('Enter a comma-separated list of ID numbers.', 'pretix-widget')}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<TextControl\r\n\t\t\t\t\t\tlabel={__('Variations', 'pretix-widget')}\r\n\t\t\t\t\t\tvalue={variations}\r\n\t\t\t\t\t\tonChange={(value) => handleChange('variations', value)}\r\n\t\t\t\t\t\thelp={__('Enter a comma-separated list of ID numbers.', 'pretix-widget')}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<TextControl\r\n\t\t\t\t\t\tlabel={__('Allocated Voucher', 'pretix-widget')}\r\n\t\t\t\t\t\tvalue={allocated_voucher}\r\n\t\t\t\t\t\tonChange={(value) => handleChange('allocated_voucher', value)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<SelectControl\r\n\t\t\t\t\t\tlabel={__('Display', 'pretix-widget')}\r\n\t\t\t\t\t\tvalue={display}\r\n\t\t\t\t\t\toptions={[\r\n\t\t\t\t\t\t\t{ value: 'list', label: __('List', 'pretix-widget') },\r\n\t\t\t\t\t\t\t{ value: 'calendar', label: __('Calendar', 'pretix-widget') },\r\n\t\t\t\t\t\t\t{ value: 'week', label: __('Week', 'pretix-widget') },\r\n\t\t\t\t\t\t\t{ value: 'grid', label: __('Grid', 'pretix-widget') },\r\n\t\t\t\t\t\t]}\r\n\t\t\t\t\t\tonChange={(value) => handleChange('display', value)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ToggleControl\r\n\t\t\t\t\t\tlabel={__('Disable Voucher', 'pretix-widget')}\r\n\t\t\t\t\t\tchecked={disable_voucher}\r\n\t\t\t\t\t\tonChange={(value) => handleChange('disable_voucher', value)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<SelectControl\r\n\t\t\t\t\t\tlabel={__('Default Language', 'pretix-widget')}\r\n\t\t\t\t\t\tvalue={language}\r\n\t\t\t\t\t\toptions={[\r\n\t\t\t\t\t\t\t{ value: 'de', label: __('German', 'pretix-widget') },\r\n\t\t\t\t\t\t\t{ value: 'en', label: __('English', 'pretix-widget') },\r\n\t\t\t\t\t\t]}\r\n\t\t\t\t\t\tonChange={(value) => handleChange('language', value)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</PanelBody>\r\n\t\t\t</InspectorControls>\r\n\t\t\t<div className=\"wp-block-pretix-widget\">\r\n\t\t\t\t{mode === 'button' ? <>Button</> :\r\n\t\t\t\t\t<pretix-widget event={shop_url} list-type={display} voucher={allocated_voucher}></pretix-widget>\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t</>\r\n\t);\r\n}\r\n","const { registerBlockType } = wp.blocks;\r\n\r\nimport metadata from './block.json';\r\nimport edit from './edit.js';\r\nimport save from './save.js';\r\n\r\nregisterBlockType('pretix-widget/widget', {\r\n\t...metadata,\r\n\tedit,\r\n\tsave,\r\n});\r\n","export default function save(props) {\r\n\treturn null;\r\n}"],"names":["_wp$element","wp","element","useEffect","useState","__","blocks","registerBlockType","i18n","_wp$components","components","TextControl","ToggleControl","SelectControl","PanelBody","ToolbarGroup","_wp$blockEditor","serverSideRender","blockEditor","InspectorControls","InnerBlocks","useBlockProps","BlockControls","store","_objectSpread","metadata","edit","props","clientId","attributes","setAttributes","align","_attributes$mode","mode","_attributes$display","display","_attributes$shop_url","shop_url","_attributes$items","items","_attributes$categorie","categories","_attributes$variation","variations","_attributes$disable_v","disable_voucher","_attributes$allocated","allocated_voucher","_attributes$language","language","_attributes$button_te","button_text","_useState2","loading","setLoading","handleChange","key","value","_defineProperty","insertScriptAssets","scriptId","script","document","getElementById","body","removeChild","createElement","id","window","PretixWidget","url","URL","src","concat","hostname","Date","now","async","onload","buildWidgets","appendChild","insertCSSAssets","linkId","link","rel","href","head","console","log","React","Fragment","label","options","onChange","title","initialOpen","type","help","checked","className","event","voucher","save"],"sourceRoot":""}